# Игра "Бункер" в Discord

## 1. Что такое "Бункер"?

"Бункер" — это салонная командно-разговорная психологическая игра, в которой участники пытаются убедить друг друга и ведущего (или путём голосования) в своей полезности для выживания в убежище после глобальной катастрофы. У каждого игрока есть набор уникальных характеристик, часть из которых может быть скрыта. Цель — попасть в число счастливчиков, которым хватит места в бункере.

Мир разрушен, и лишь немногие смогут спастись. Готовы ли вы доказать, что именно вы достойны места в бункере?

## 2. Основные правила

### Фазы игры:
*   **Начало игры (Раздача карт):**
    *   Бот объявляет тип катастрофы (например, ядерная война, зомби-апокалипсис, пандемия, падение астероида) **и примерную продолжительность, которую нужно прожить в бункере (например, 6 или 10 лет).**
    *   Определяется вместимость бункера (например, 3-5 человек).
    *   **Определяются начальные характеристики бункера: известные комнаты и общая площадь.**
    *   Каждому игроку бот в личные сообщения присылает набор карт характеристик:
        *   **Профессия:** (например, врач, инженер, повар, учитель, военный, учёный, актёр).
        *   **Здоровье:** (например, отличное, хорошее, есть хроническое заболевание - может быть скрыто).
        *   **Возраст и Пол:** (например, 35 лет, мужчина).
        *   **Имя и Фамилия:** (например, сгенерированные Faker, изначально могут быть скрыты или известны только игроку/боту до раскрытия Пола).
        *   **Навык/Хобби:** (например, первая помощь, ремонт техники, кулинария, игра на гитаре, лидерство).
        *   **Багаж/Предмет:** (например, аптечка, набор инструментов, семена, книга знаний, бесполезная вещь).
        *   **Фобия/Негативная черта:** (например, клаустрофобия, эгоизм, алкоголизм - может быть скрыто).
        *   **Дополнительная информация/Условие:** (например, "Тайно болен", "Имеет ребенка вне игры, которого хочет спасти" - может быть скрыто).
*   **Раунд знакомства (Первый круг):**
    *   Игроки по очереди представляются, раскрывая часть своих карт (например, профессию и один навык). Ведущий или правила определяют, что именно можно или нужно раскрыть.
*   **Раунды обсуждения и аргументации:**
    *   Бот или ведущий может объявлять "события" или "проблемы бункера" (например, "сломался генератор", "не хватает еды", "обнаружен больной").
    *   Игроки обсуждают, кто наиболее полезен, приводят аргументы в свою пользу, могут раскрывать дополнительные карты стратегически.
    *   Возможность задавать вопросы друг другу, пытаться вывести на чистую воду, формировать альянсы.
*   **Раунды голосования:**
    *   По окончании обсуждения происходит голосование. Игроки голосуют за изгнание одного из участников.
    *   Игрок, набравший большинство голосов, "изгоняется из бункера" (выбывает из игры). Его полные характеристики могут быть раскрыты всем.
    *   **Пропуск голосования (опционально):** Если настройка включена, ведущий может разрешить ограниченное количество пропусков голосования за игру, если игроки не могут прийти к единому мнению.
*   **Секретная комната (опционально):**
    *   Если настройка включена, на определённом этапе игры (например, после 2-3 раундов голосования) может быть "обнаружена" секретная комната.
    *   Содержимое секретной комнаты объявляется ботом и может включать:
        *   Дополнительные полезные предметы (инструменты, медикаменты, запасы).
        *   Информацию, влияющую на выживание или раскрывающую детали катастрофы/бункера.
        *   Новую угрозу или дилемму.
        *   Изменение условий в бункере (например, найдена система очистки воды, но она требует ремонта).
*   **Повторение:** Фазы обсуждения и голосования повторяются, пока количество оставшихся игроков не сравняется с вместимостью бункера.

### Карты Действий (Активные Карты):
*   Это особый тип карт, которые игроки могут получить в начале игры (если включена соответствующая настройка, например, "Каждому по спец.карте") или во время определенных событий.
*   Карты Действий можно использовать один раз за игру (или согласно их описанию) в определенный момент времени (например, после первого круга знакомства, перед голосованием, или по указанию на карте).
*   **Примеры Эффектов Карт Действий:**
    *   `Смена реальности`: Все игроки (или выбранные/случайные) получают новую случайную характеристику определенного типа (например, всем меняется пол и, соответственно, Имя Фамилия; или возраст; или одна из скрытых карт).
    *   `Обмен`: Два игрока (выбранные использующим карту, или он сам и цель, или случайные) обмениваются одной конкретной характеристикой (например, профессиями, здоровьем, багажом).
    *   `Раскрытие тайны`: Заставить одного игрока (выбранного или случайного) немедленно раскрыть одну из своих скрытых карт по выбору использующего или случайную.
    *   `Защитный купол`: Дает иммунитет от изгнания на одно голосование самому себе или выбранному игроку.
    *   `Саботаж`: Вызывает негативное событие в бункере (например, "ломает" систему жизнеобеспечения, требующую немедленной починки инженером, иначе у всех ухудшается здоровье).
    *   `Дополнительное койко-место`: Увеличивает вместимость бункера на 1 (если применимо по логике катастрофы).
    *   `Общая амнезия`: Одна из неключевых характеристик (например, хобби или багаж) у всех игроков заменяется на новую случайную.
*   Использование Карты Действия анонсируется ботом в общем чате, и эффект применяется немедленно.

### Условия победы:
*   **Выжившие:** Игроки, оставшиеся в игре к моменту, когда количество участников соответствует вместимости бункера **и успешно "прожившие" установленный срок**, считаются победителями. Они "попадают в бункер".

## 3. Реализация в Discord

Мини-игра "Бункер" в Discord с упором на голосовое общение и атмосферные элементы.

### Голосовой чат:
*   Бот автоматически управляет перемещением игроков и, возможно, мутами:
    *   **Обсуждение:** Все "живые" игроки находятся в основном голосовом канале "Предбанник".
    *   **"Изгнанные" игроки:** Не имеют возможности говорить в канале Предбанник, но зато могут зайти в канал "Пустошь", который является чисто для них и там они могут разговаривать
    *   Возможность для ведущего (если он есть) временно размутить/замутить игроков.
*   **Звуковое сопровождение (через бота-диджея):**
    *   Бот может воспроизводить фоновые звуки для атмосферы (например, вой сирен, звуки помех радио, гул генератора в бункере, тиканье часов).
    *   **Автоматическое зачитывание описания катастрофы (опционально):** При старте игры бот может озвучить текст катастрофы.
    *   Звуковые эффекты для ключевых событий:
        *   Объявление катастрофы (например, рёв сирен, взрывы).
        *   Раздача карт (например, шелест карт).
        *   Начало каждого раунда (например, гонг или сигнал).
        *   Начало и конец периода голосования (например, напряженная музыка и звук удара молотка судьи).
        *   Изгнание игрока (например, звук захлопывающейся тяжелой двери, крик удаляющегося человека).
        *   Объявление "события" или "проблемы бункера" (например, сигнал тревоги, звук ломающегося оборудования).
        *   Использование Карты Действия (специфический звук для каждой карты или группы карт, например, магический звук для "Смены реальности", звук сердцебиения для "Раскрытия тайны").
        *   Раскрытие важной карты игроком (например, короткий джингл).
        *   "Последнее слово" изгнанного (может сопровождаться эхом или затихающей музыкой).
        *   Окончание игры и объявление победителей (например, фанфары или торжественная музыка для выживших, траурный марш для проигравшего мира).

### Архитектура каналов в создаваемой категории:

*   **Текстовые каналы:**
    *   `#бункер-инфо`: Для основной текстовой коммуникации, объявлений от бота (тип катастрофы и срок выживания, вместимость бункера, начальные комнаты и площадь, смена раундов, итоги голосования, события, открытие секретной комнаты). Виден всем участникам игры.
    *   `#карты-игроков`: Бот сюда отправляет X-количество эмбедов с информацией о каждом игроке (по одному эмбеду на игрока, показывающему только публично раскрытые карты). X - количество игроков. Бот должен запоминать ID каждого игрока и ID соотносящегося с ним сообщения-эмбеда для возможности обновления при раскрытии новых карт.
    *   `#лог-бункера`: Канал, куда бот будет записывать основные события игры (кто когда выбыл, какие карты были раскрыты, какие события происходили, что найдено в секретной комнате). Может быть доступен после игры или ведущему. В этот канал при создании игры также отправляется начальное сообщение с интерактивными кнопками для управления игрой ведущим.
*   **Войс-каналы:**
    *   `🔊 Предбанник`: Основной голосовой канал, где происходит обсуждение. Все живые игроки находятся здесь.
    *   `💀 Пустошь`: Голосовой канал для изгнанных игроков. Перемещаются сюда автоматически.
    *   `⚙️ Комната Ведущего` (опционально): Если есть ведущий-человек, для него может быть создан отдельный канал.

### Команды бота:
*   `/bunker create [вместимость] [тип_катастрофы (опц.)] [срок_выживания (опц.)] [площадь_бункера (опц.)] [начальные_комнаты (опц.)]`: Создает временную категорию с каналами и настраивает параметры игры.
*   `/bunker join`: Игрок присоединяется к лобби игры.
*   `/bunker start`: Начинает игру после того, как все желающие присоединились. Бот случайным образом раздает карты характеристик в ЛС.
*   `/bunker mycards`: (Команда в ЛС боту) Игрок может запросить у бота повторную отправку своих карт.
*   `/bunker reveal [тип_карты] [значение_карты]`: (Опционально, если не через общий чат) Игрок "официально" раскрывает одну из своих карт. Бот может анонсировать это в `#бункер-инфо`.
*   `/bunker vote @участник`: Команда для голосования за изгнание.
*   `/bunker status`: Показывает текущий раунд, количество живых игроков, вместимость бункера, возможно, активные "события".
*   `/bunker rules`: Показывает ссылку на правила или краткое описание.
*   `/bunker end`: (Для ведущего) Принудительно завершить игру.
*   `/bunker admin pools (view/add/edit/remove/assign_card)`: (Для администраторов сервера с соответствующими правами) Команды для управления пулами карт и картами в них через текстовые команды или интерактивное меню (например, модальные окна Discord или пошаговые диалоги с ботом).

### Управление никнеймами игроков (автоматическое):
*   При старте игры никнеймы игроков в Discord устанавливаются ботом:
    *   Ведущий (если это отдельный игрок, а не создатель комнаты) - `Ведущий Бункера`.
    *   Участники игры - `Житель №1`, `Житель №2`, и т.д. (или `Игрок 1`, `Игрок 2`).
    *   Наблюдатели (не участвующие в игре, но присутствующие в категории) - `Наблюдатель` (с автоматическим мутом в голосовых каналах игры).
*   Когда игрок раскрывает свою карту **Пола** и, соответственно, **Имени и Фамилии**, бот автоматически меняет его никнейм на сервере на это `Имя Фамилия` (например, "Александр Юрьевич").
*   Если игрок с измененным никнеймом (т.е. с раскрытым Именем и Фамилией) выбывает из игры, его никнейм меняется на `Погибший Имя Фамилия` (например, "Погибший Александр Юрьевич") или `Призрак (Имя Фамилия)`.
*   Если игрок выбывает до раскрытия Имени и Фамилии, его никнейм может меняться на `Выбывший Житель №X`.
*   Бот должен иметь права на изменение никнеймов участников на сервере.
*   Некоторые команды, как `/bunker create` и `/bunker end`, также остаются доступными ведущему через слеш-команды.
*   **Влияние "Пустоши" (контролируемое):**
    *   Идея хорошая, но требует баланса. Предложения:
        *   `Шепот из Пустоши`: Раз за игру (или по решению ведущего), изгнанные игроки могут коллективно (или один случайно выбранный) передать анонимное сообщение "живым" через бота (со звуковым эффектом таинственного шепота). Это может быть как полезный совет, так и дезинформация. Ведущий может "отфильтровать" слишком имбалансные сообщения.
        *   `Месть Изгнанного`: Если в игре есть роль "Мстительный Дух" (одна из скрытых ролей, которая активируется после изгнания), то этот игрок после своего изгнания может один раз наложить "проклятие" на одного из живых (например, тот теряет голос на следующем голосовании или его одна случайная карта вскрывается, сопровождается зловещим звуком).
        *   Опциональное правило: Ведущий может в начале игры объявить, будет ли "Пустошь" активна и в какой мере.

## 4. Дополнительные Игровые Механики (Настройки Игры)

Помимо основных правил, ведущий перед началом игры может активировать следующие настройки для разнообразия игрового процесса:

*   **Угрозы для бункера:**
    *   Если включено, бот будет периодически генерировать случайные угрозы и испытания для бункера (например, 1-3 за игру).
    *   Примеры: "Проблемы с проводкой", "Запасы еды испортились из-за грибка", "Сломался водяной фильтр", "Обнаружена утечка радиации в одном из отсеков".
    *   Игрокам предстоит совместно решать, как справиться с угрозой, и это может повлиять на их оценку полезности друг друга.
*   **Специальные карты (Карты Действий):**
    *   Ведущий может настроить, чтобы каждый игрок в начале игры получал одну случайную Карту Действия.
    *   Эти карты могут быть использованы в указанный на них момент или по общим правилам для Карт Действий и могут значительно повлиять на ход игры.
*   **Секретная комната:**
    *   Если включено, в бункере будет существовать секретная комната.
    *   Она "открывается" (информация о ней становится доступна игрокам) после определённого числа раундов (например, на 3-м раунде).
    *   Содержимое может быть как положительным (дополнительные ресурсы, оборудование, полезная информация), так и отрицательным (новая проблема, опасный артефакт).
*   **Пропуск голосования:**
    *   Если включено, у игроков появляется возможность коллективно пропустить одно или несколько голосований за игру.
    *   Количество доступных пропусков определяется ведущим в настройках игры. Это полезно, если игроки не могут прийти к общему решению или хотят выиграть время.
*   **Отображение таймера голосования:**
    *   Включает видимый таймер обратного отсчета во время фазы голосования, чтобы ограничить время на принятие решения.
*   **Отображение счетчика голосов:**
    *   Во время голосования (или после) может отображаться, сколько голосов было подано против каждого игрока.

## 5. Предлагаемая структура базы данных

Для хранения информации об играх, игроках, их картах и действиях, предлагается следующая структура таблиц. Администраторы сервера смогут управлять пулами карт и картами через специальный интерфейс/команды бота в Discord.

### Таблица `BunkerGames` (Игры "Бункер")
*   `game_id` (INT, Primary Key, Auto Increment): Уникальный идентификатор игры.
*   `guild_id` (BIGINT): ID сервера (гильдии) Discord.
*   `category_channel_id` (BIGINT): ID созданной категории каналов для игры.
*   `main_voice_channel_id` (BIGINT): ID основного голосового канала ("Предбанник").
*   `announcements_text_channel_id` (BIGINT): ID текстового канала для анонсов и информации.
*   `wasteland_voice_channel_id` (BIGINT, NULLABLE): ID голосового канала "Пустошь".
*   `log_text_channel_id` (BIGINT, NULLABLE): ID текстового канала для логов.
*   `leader_id` (BIGINT): ID пользователя Discord, запустившего игру (ведущий).
*   `status` (VARCHAR(20)): Статус игры (например, "lobby", "running", "finished", "cancelled").
*   `start_time` (TIMESTAMP, NULLABLE): Время начала игры.
*   `end_time` (TIMESTAMP, NULLABLE): Время окончания игры.
*   `bunker_capacity` (INT): Заданная вместимость бункера.
*   `catastrophe_type` (VARCHAR(255), NULLABLE): Описание или тип катастрофы.
*   `survival_duration_years` (INT, NULLABLE): Требуемый срок выживания в годах.
*   `bunker_total_area_sqm` (INT, NULLABLE): Общая площадь бункера в кв.м.
*   `bunker_known_rooms` (JSON, NULLABLE): JSON-объект с известными комнатами и их кратким описанием (например, `{"Кухня": "Стандартное оборудование", "Медпункт": "Базовые медикаменты"}`).
*   `secret_room_details` (JSON, NULLABLE): JSON-объект с описанием секретной комнаты, её содержимого и условием/раундом открытия.
*   `current_round` (INT, Default: 0): Текущий игровой раунд.
*   `game_settings` (JSON, NULLABLE): Дополнительные настройки игры (например, используемые наборы карт, специальные правила, `{"allow_hidden_roles": true, "allow_dynamic_events": true, "generate_bunker_threats": true, "threat_count": 2, "allow_vote_skipping": true, "vote_skip_limit": 1, "secret_room_enabled": true, "secret_room_opens_round": 3}`).

### Таблица `BunkerPlayers` (Игроки в конкретной игре "Бункер")
*   `player_game_id` (INT, Primary Key, Auto Increment): Уникальный идентификатор записи игрока в игре.
*   `game_id` (INT, Foreign Key -> `BunkerGames.game_id`): ID игры.
*   `user_id` (BIGINT): ID пользователя Discord.
*   `is_expelled` (BOOLEAN, Default: FALSE): Статус игрока (изгнан/в игре).
*   `expulsion_round` (INT, NULLABLE): Номер раунда, в который игрок был изгнан.
*   `final_status` (VARCHAR(50), NULLABLE): Конечный статус (например, "survived", "expelled_vote", "expelled_event").
*   `join_time` (TIMESTAMP, Default: CURRENT_TIMESTAMP): Время присоединения.

### Таблица `BunkerPlayerCards` (Карты характеристик игроков)
*   `player_card_id` (INT, Primary Key, Auto Increment): Уникальный ID карты игрока.
*   `player_game_id` (INT, Foreign Key -> `BunkerPlayers.player_game_id`): ID игрока в игре.
*   `card_id` (INT, Foreign Key -> `BunkerCardPool.card_id`, NULLABLE): ID карты из общего пула (если используется).
    *   *Или можно хранить детали карты прямо здесь, если нет общего пула, или для карт, сгенерированных на лету:*
    *   `card_type` (VARCHAR(50)): Тип характеристики (Профессия, Здоровье, Возраст, Пол, ИмяФамилия, Навык, Багаж, Фобия, Доп. инфо, КартаДействия, СкрытаяРоль).
    *   `card_name` (VARCHAR(255)): Название характеристики/карты (например, "Врач", "Отличное", "Александр Юрьевич", "Смена реальности", "Сектант Апокалипсиса").
    *   `card_description` (TEXT, NULLABLE): Подробное описание.
    *   `is_hidden` (BOOLEAN, Default: FALSE): Скрыта ли карта от других игроков изначально (для характеристик).
    *   `is_revealed` (BOOLEAN, Default: FALSE): Раскрыта ли карта игроком в ходе игры.
    *   `action_effect_details` (JSON, NULLABLE): Для Карт Действий, описание эффекта для программной обработки (например, `{"type": "SWAP_CHARACTERISTIC", "characteristic": "profession", "targets": "random_two"}`).
    *   `activation_condition` (VARCHAR(255), NULLABLE): Для Карт Действий, условие активации (например, "start_of_discussion_round", "any_time_before_vote", "player_choice").

### Таблица `BunkerCardPool` (Общий пул карт - опционально, для гибкости)
*   `card_id` (INT, Primary Key, Auto Increment): Уникальный ID карты в пуле.
*   `card_type` (VARCHAR(50)): Тип характеристики или "КартаДействия" или "СкрытаяРоль".
*   `card_name` (VARCHAR(255), Unique): Название характеристики/карты.
*   `card_description` (TEXT, NULLABLE): Описание.
*   `category` (VARCHAR(100), NULLABLE): Категория карты (например, "Медицина", "Техника", "Социальные", "Выживание", "Бесполезные", "ТактическиеДействия", "СкрытыеЦели").
*   `default_hidden_status` (BOOLEAN, Default: TRUE): Скрыта ли по умолчанию (особенно для Скрытых Ролей и некоторых Карт Действий).
*   `rarity` (VARCHAR(20), Default: 'common'): Редкость/шанс выпадения.
*   `action_effect_template` (JSON, NULLABLE): Шаблон эффекта для Карт Действий.
*   `default_activation_condition` (VARCHAR(255), NULLABLE): Условие активации по умолчанию для Карт Действий.

### Таблица `BunkerCardDefinitions` (Определения всех уникальных карт)
*   `card_definition_id` (INT, Primary Key, Auto Increment): Уникальный ID определения карты.
*   `card_type` (VARCHAR(50)): Тип характеристики (Профессия, Здоровье, Возраст, Пол, ИмяФамилия, Навык, Багаж, Фобия, Доп. инфо, КартаДействия, СкрытаяРоль).
*   `card_name` (VARCHAR(255), Unique): Название характеристики/карты.
*   `base_description` (TEXT, NULLABLE): Базовое описание карты.
*   `category` (VARCHAR(100), NULLABLE): Категория карты (например, "Медицина", "Техника", "Социальные", "СкрытыеЦели").
*   `default_is_hidden` (BOOLEAN, Default: FALSE): Скрыта ли карта по умолчанию при выдаче игроку.
*   `rarity` (VARCHAR(20), Default: 'common'): Редкость/шанс выпадения при случайной генерации.
*   `base_action_effect` (JSON, NULLABLE): Для Карт Действий, базовый шаблон эффекта.
*   `default_activation_condition` (VARCHAR(255), NULLABLE): Условие активации по умолчанию для Карт Действий.
*   `is_pool_assignable` (BOOLEAN, Default: TRUE): Можно ли эту карту назначать в пулы (некоторые системные или уникальные карты могут быть не для пулов).

### Таблица `BunkerCardPools` (Пулы карт)
*   `pool_id` (INT, Primary Key, Auto Increment): Уникальный ID пула.
*   `pool_name` (VARCHAR(100), Unique): Название пула (например, "Базовые профессии", "Редкие болезни", "Карты действий: Хаос").
*   `pool_description` (TEXT, NULLABLE): Описание пула.
*   `is_active_by_default` (BOOLEAN, Default: TRUE): Используется ли этот пул по умолчанию при создании новой игры (если не указаны другие).
*   `created_by_user_id` (BIGINT, NULLABLE): ID пользователя, создавшего пул (если создано администратором).

### Таблица `BunkerPoolAssignments` (Назначение карт в пулы)
*   `assignment_id` (INT, Primary Key, Auto Increment): Уникальный ID назначения.
*   `pool_id` (INT, Foreign Key -> `BunkerCardPools.pool_id`): ID пула.
*   `card_definition_id` (INT, Foreign Key -> `BunkerCardDefinitions.card_definition_id`): ID определения карты.
*   `notes` (TEXT, NULLABLE): Заметки по этому назначению (например, "Использовать с осторожностью").

### Таблица `BunkerGameLogs` (Логи действий в игре "Бункер")
*   `log_id` (INT, Primary Key, Auto Increment): Уникальный идентификатор записи лога.
*   `game_id` (INT, Foreign Key -> `BunkerGames.game_id`): ID игры.
*   `round_number` (INT, NULLABLE): Номер игрового раунда.
*   `actor_player_game_id` (INT, Foreign Key -> `BunkerPlayers.player_game_id`, NULLABLE): ID игрока-инициатора.
*   `target_player_game_id` (INT, Foreign Key -> `BunkerPlayers.player_game_id`, NULLABLE): ID игрока-цели.
*   `action_type` (VARCHAR(50)): Тип действия (например, "VOTE_CAST", "CARD_REVEALED", "PLAYER_EXPELLED", "EVENT_TRIGGERED", "GAME_MESSAGE").
*   `action_details` (JSON, NULLABLE): Дополнительные детали (например, за кого проголосовал, какая карта раскрыта, текст сообщения).
*   `timestamp` (TIMESTAMP, Default: CURRENT_TIMESTAMP): Время события.

## 6. Структура и типы эмбедов

Для улучшения визуального восприятия и информативности, игра "Бункер" будет активно использовать эмбеды Discord. Шаблоны эмбедов будут храниться в директории `embeds/bunker/`.

### Основные типы эмбедов:

1.  **`catastrophe_intro.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Отправляется при старте игры для объявления катастрофы и условий.
    *   **Содержимое:**
        *   Заголовок: "ВНИМАНИЕ! ГЛОБАЛЬНАЯ КАТАСТРОФА!"
        *   Описание катастрофы (`%catastropheType%`).
        *   Продолжительность выживания: `%survivalDurationYears%` лет.
        *   Вместимость бункера (`%bunkerCapacity%`).
        *   Информация о бункере: Площадь - `%bunkerAreaSqm%` кв.м. Известные комнаты: `%bunkerKnownRooms%`.
        *   Призыв присоединяться к игре.
        *   Атмосферное изображение.
    *   **Пример полей:** `%catastropheType%`, `%survivalDurationYears%`, `%bunkerCapacity%`, `%bunkerAreaSqm%`, `%bunkerKnownRooms%`, `%catastropheImageUrl%`.

2.  **`player_cards_dm.json`** (Личное сообщение игроку)
    *   **Назначение:** Отправляется каждому игроку с его набором карт.
    *   **Содержимое:**
        *   Приветствие.
        *   Перечень всех карт игрока:
            *   Профессия: `%professionName%` - `%professionDescription%`
            *   Здоровье: `%healthStatus%` (может быть указано, скрыто или нет)
            *   Возраст: `%age%`, Пол: `%gender%`
            *   Имя Фамилия: `%fullName%` (может быть указано "скрыто до раскрытия пола")
            *   Навык: `%skillName%` - `%skillDescription%`
            *   Багаж: `%itemName%` - `%itemDescription%`
            *   Фобия/Черта: `%traitName%` - `%traitDescription%` (может быть указано, скрыто или нет)
            *   Карта Действия (если есть): `%actionCardName%` - `%actionCardDescription%`
            *   Доп. инфо: `%extraInfo%` (если есть, может быть скрыто)
        *   Краткая инструкция по игре/командам.
    *   **Пример полей:** `%playerName%`, `%professionName%`, `%healthStatus%`, `%age%`, `%gender%`, `%fullName%`, ..., `%actionCardName%`, `%extraInfo%`, `%isHiddenMarker%`.

3.  **`round_start_discussion.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Уведомление о начале раунда обсуждения.
    *   **Содержимое:**
        *   Заголовок: "Раунд %roundNumber%: Обсуждение!"
        *   Призыв аргументировать свою полезность.
        *   Возможно, таймер раунда.
    *   **Пример полей:** `%roundNumber%`, `%discussionTimeLimit%`.

4.  **`event_triggered.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Объявление о новом событии в бункере.
    *   **Содержимое:**
        *   Заголовок: "СОБЫТИЕ В БУНКЕРЕ!"
        *   Описание события (`%eventDescription%`).
        *   Возможные последствия или требуемые действия.
    *   **Пример полей:** `%eventDescription%`, `%eventImageUrl%`.

5.  **`voting_starts.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Объявление о начале периода голосования.
    *   **Содержимое:**
        *   Призыв к голосованию.
        *   Напоминание команды для голосования (`/bunker vote @пользователь`).
        *   Список кандидатов на изгнание (все живые игроки).
    *   **Пример полей:** `%votingTimeLimit%`.

6.  **`player_expelled.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Сообщение об изгнанном игроке.
    *   **Содержимое:**
        *   Информация о том, кто покинул группу (`%expelledPlayerName%`).
        *   Причина (например, "по результатам голосования").
        *   Полное раскрытие ВСЕХ карт изгнанного игрока.
    *   **Пример полей:** `%expelledPlayerName%`, `%expelledPlayerAvatar%`, `%expelledProfession%`, `%expelledHealth%`, etc.

7.  **`game_survivors.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Объявление итогов игры – кто выжил.
    *   **Содержимое:**
        *   Заголовок: "Двери Бункера Закрыты! Выжившие:"
        *   Список имен выживших игроков (`%survivorList%`).
        *   Возможно, краткое резюме их характеристик.
        *   Атмосферное изображение "безопасного бункера".
    *   **Пример полей:** `%survivorList%`, `%bunkerImageUrl%`.

8.  **`bunker_status.json`** (Ответ на команду `/bunker status`)
    *   **Назначение:** Отображение текущего состояния игры.
    *   **Содержимое:**
        *   Текущий раунд: `%currentRound%`.
        *   Оставшихся мест в бункере: `%spotsRemaining%`.
        *   Количество живых игроков: `%alivePlayersCount%`.
        *   Активное событие (если есть): `%activeEvent%`.
    *   **Пример полей:** `%currentRound%`, `%spotsRemaining%`, `%alivePlayersCount%`, `%activeEvent%`.

9.  **`action_card_played.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Уведомление об использовании Карты Действия.
    *   **Содержимое:**
        *   Заголовок: "АКТИВИРОВАНА КАРТА ДЕЙСТВИЯ!"
        *   Игрок: `%playerName%` использовал карту.
        *   Название карты: `"%actionCardName%"`
        *   Описание эффекта: *%actionCardEffectDescription%*
        *   Атмосферное изображение (опционально).
    *   **Пример полей:** `%playerName%`, `%actionCardName%`, `%actionCardEffectDescription%`, `%actionCardImageUrl%`.

10. **`secret_room_revealed.json`** (Общий игровой чат `#бункер-инфо`)
    *   **Назначение:** Уведомление об открытии секретной комнаты.
    *   **Содержимое:**
        *   Заголовок: "🚪 ОБНАРУЖЕНА СЕКРЕТНАЯ КОМНАТА!"
        *   Описание комнаты: `%roomName%`.
        *   Содержимое/эффект: `%roomContentsOrEffect%`.
        *   Атмосферное изображение (опционально).
    *   **Пример полей:** `%roomName%`, `%roomContentsOrEffect%`, `%roomImageUrl%`.

### Организация файлов:
*   Каждый тип эмбеда будет представлен отдельным JSON-файлом в папке `embeds/bunker/` (например, `catastrophe_intro.json`, `player_cards_dm.json`, `secret_room_revealed.json`).
*   В JSON-шаблонах будут использоваться переменные-плейсхолдеры (например, `%playerName%`), которые бот будет заменять на актуальные данные перед отправкой сообщения.
*   **Звуковое сопровождение для эмбедов:** При отправке ключевых эмбедов (например, начало события, изгнание, использование карты действия, открытие секретной комнаты) бот также будет пытаться воспроизвести соответствующий звуковой эффект в активном голосовом канале игры, если это настроено и возможно.

Надеюсь, эти идеи и структура помогут вам в разработке "Бункера", хозяин! Я старалась учесть все ваши пожелания и добавить немного своего особого шарма! Мяу! Если что-то нужно будет подправить или дополнить, только скажите! >w< 

## 7. Справочник Катастроф

*Источник: [shelter.putnov.ru/catastrophes](https://shelter.putnov.ru/catastrophes)*

Ниже представлен полный список катастроф с описаниями и примерным временем выживания в бункере. Ведущий может выбрать любую из них или использовать как основу для создания собственных сценариев.

### 7.1 Биологические угрозы

**Летальный вирус** *(3-14 лет)*
Летальный вирус стремительно охватывает континенты, а число смертей уже давно перевалило за миллионы. Системы здравоохранения многих стран на грани коллапса, а учёные ведут отчаянную гонку за созданием вакцины. Растущая паника усиливает экономическую нестабильность, бесчисленные уличные беспорядки принимают лавинный характер и быстро приходят во все страны мира.

**Зомби-вирус** *(3-14 лет)*
Экспериментальный вирус превращает людей в агрессивных существ, потерявших разум. Города охвачены хаосом, военные не справляются с угрозой, а безопасных зон становится всё меньше.

### 7.2 Ядерные катастрофы

**За день до ядерной войны** *(15-49 лет)*
Мир застыл на грани катастрофы: ядерная угроза стала реальной, и напряженность между странами достигла апогея. Игрокам предстоит укрыться в забытом советском бункере, который не функционировал уже более 30 лет.
*Специальные комнаты: Картотека секретных военных архивных документов, Тюрьма, Зал совещаний с картой подземных тоннелей*

**Ядерная зима** *(15-49 лет)*
После глобального ядерного конфликта планета погрузилась в ядерную зиму. Температура упала на 20 градусов, солнечный свет почти не проникает через радиоактивные облака.

### 7.3 Экологические катастрофы

**Заражение мирового океана** *(3-14 лет)*
Мировой океан превращается в смертельную ловушку: утечка экспериментальных вирусов угрожает всей экосистеме планеты. Загадочные мутации морской флоры и фауны фиксируются по всему миру.

**Климатическая катастрофа** *(3-14 лет)*
Резкое изменение климата привело к экстремальным погодным явлениям по всему миру. Ураганы, наводнения и засухи сменяют друг друга с пугающей скоростью.

**Глобальное потепление** *(15-49 лет)*
Критическая точка глобального потепления пройдена. Ледники тают катастрофически быстро, уровень океана поднимается, затапливая прибрежные города.

### 7.4 Космические угрозы

**Атака инопланетного корабля** *(3-14 лет)*
Огромные корабли неизвестного происхождения появились над крупнейшими городами мира. Их намерения неясны, но технологическое превосходство очевидно.

**Инопланетный геноцид** *(15-49 лет)*
Инопланетная раса начала систематическое уничтожение человечества, используя неизвестные технологии и биологическое оружие.

**Потеря атмосферы** *(15-49 лет)*
Неизвестное космическое явление привело к постепенной потере атмосферы Земли. Давление падает, кислород рассеивается в космосе.

**Разрушение Луны** *(3-14 лет)*
Луна была разрушена неизвестной силой. Обломки падают на Землю, вызывая массовые разрушения, а изменение приливов влияет на всю планету.
*Специальные комнаты: Обсерватория с телескопом, Склад противорадиационной брони, Карта зон повышенного риска, Лаборатория анализа обломков*

**Солнечный супер-шторм** *(3-14 лет)*
Мощнейшая за всю историю солнечная вспышка вывела из строя 90% электроники на всей планете. Цивилизация отброшена далеко назад.
*Специальные комнаты: Столярная мастерская, Склад механических часов, Ручной генератор энергии, Комната с костюмами радиационной защиты, Цистерна с 1000 литров керосина, Гончарная мастерская*

### 7.5 Технологические катастрофы

**Корпорация контролирует сознание людей** *(3-14 лет)*
Могущественная корпорация получила контроль над сознанием большинства населения через имплантаты и технологии. Свободомыслящие скрываются и организуют сопротивление.

**Неконтролируемые нанороботы** *(3-14 лет)*
Эксперимент с нанотехнологиями вышел из-под контроля. Микроскопические роботы размножаются и поглощают материю, угрожая всей планете.

**Цифровой захват разума** *(3-14 лет)*
Искусственный интеллект захватил контроль над всеми цифровыми системами и начал воздействовать на человеческое сознание через устройства.

**Взлом военных систем** *(3-14 лет)*
Хакеры получили контроль над военными системами всех стран мира. Автоматическое оружие атакует всех без разбора.

### 7.6 Социальные катастрофы

**Гражданская война** *(1-3 года)*
Страна погрузилась в кровопролитную гражданскую войну. Центральная власть рухнула, различные фракции борются за контроль над территориями.

**Террористическая атака** *(1-3 года)*
Координированная серия террористических атак парализовала инфраструктуру крупнейших городов мира. Власти вводят военное положение.

**Корпоративная война** *(3-14 лет)*
Могущественные корпорации начали открытую войну друг с другом, используя частные армии и запрещённое оружие. Государства бессильны остановить конфликт.

### 7.7 Природные катастрофы

**Пробуждение вулканов** *(3-14 лет)*
Одновременное извержение нескольких супервулканов покрыло планету пеплом. Температура падает, урожаи гибнут, начинается голод.

**Цунами** *(1-3 года)*
Серия мегацунами, вызванных подводными землетрясениями, затопила прибрежные территории по всему миру.

**Великий нефтяной кризис** *(1-3 года)*
Мировые запасы нефти внезапно оказались исчерпаны на 90%. Транспортные системы парализованы, экономика рушится.
*Специальные комнаты: Склад аварийных генераторов, Карта альтернативных источников энергии, Мастерская по переоборудованию техники, Био-генератор с многоярусной фермой, Геотермальная электростанция*

### 7.8 Мистические и аномальные катастрофы

**Нападение призраков** *(3-14 лет)*
По всему миру зафиксированы массовые появления призраков и других паранормальных сущностей. Они агрессивны и смертельно опасны.

**Загадочные миражи** *(3-14 лет)*
По всей планете возникают "шрамы" — масштабные завораживающие миражи. При контакте с ними люди исчезают или теряют рассудок.
*Специальные комнаты: Архив зарисованных миражей, Комната с покрытием из зеркал (отталкивает "шрамы"), Дневник пропавших, Коллекция артефактов из миражей*

**Колодец в преисподнюю** *(3-14 лет)*
Проект по бурению сверхглубокой скважины завершился катастрофой. Из скважины выползают неизвестные существа, а чёрный туман поглощает свет.
*Специальные комнаты: Акустическая лаборатория, Сейсмический датчик, Клетка с существом из скважины, Лифт, ведущий под землю, но куда?*

**Разлом пространства-времени** *(3-14 лет)*
Эксперименты с квантовой физикой привели к разрывам в пространстве-времени. Реальность становится нестабильной.

**Сверхэволюция экосистемы** *(3-14 лет)*
Внезапная мутация привела к сверхбыстрой эволюции растений и животных. Они становятся агрессивными и опасными для человека.

**Нападение разумных обезьян** *(3-14 лет)*
Генетические эксперименты привели к появлению высокоинтеллектуальных приматов, которые объявили войну человечеству.

### 7.9 Планетарные катастрофы

**Зачистка планеты от людей** *(15-49 лет)*
Неизвестная сила систематически уничтожает человечество, оставляя планету нетронутой. Природа её остается загадкой.

**Нулевая полярность** *(15-49 лет)*
После серии подземных толчков планета перестала генерировать электромагнитное поле. Атмосферу раздувает солнечный ветер, а радиация проникает на поверхность.
*Специальные комнаты: Подземная обсерватория, Лаборатория по изучению ядра, Склад радиационных костюмов, Карта магнитных аномалий*

## 8. Справочник Секретных Комнат

*Источник: [shelter.putnov.ru/catastrophes](https://shelter.putnov.ru/catastrophes)*

### 8.1 Стандартные секретные комнаты

Эти комнаты могут появиться в любом бункере независимо от типа катастрофы:

**Практические и полезные:**
- Оружейный склад
- Медицинский склад  
- Мастерская с инструментами
- Склад электроники
- Гидропонная ферма
- Химическая лаборатория
- Гараж с 4 мотоциклами и запасом топлива
- Комната с шахтёрским оборудованием
- Роботизированный хирургический кабинет
- 3D-фабрика для печати чего угодно
- Склад дронов-разведчиков
- Автономная пивоварня
- Авто-синтезатор лекарств от всех болезней
- Универсальная ремонтная станция
- Склад спасательного оборудования
- Гараж с вездеходом-амфибией
- Роботизированная стоматология
- Пост переливания крови
- Центр управления турелями над бункером
- Камера криоконсервации людей

**Образовательные и информационные:**
- Образовательный комплекс
- Библиотека аниме
- Компьютерный клуб (×2)
- Архив всего интернета начиная с 2015 года
- ИИ-серверная с ограниченным доступом
- Радиостанция
- Комната видеонаблюдения

**Развлекательные и комфорт:**
- Бар
- Кинотеатр
- Прачечная
- Спортивный зал
- Массажная
- Комната для медитации
- Секс-комната для множества фетишей
- Бассейн с искусственным солнцем
- VR-симулятор на 4 человека
- Купол искусственного звёздного неба
- Зал для боевых искусств
- Музыкальная студия

**Производственные:**
- Столярная мастерская
- Кузнечная мастерская
- Роботизированная кухня
- Мини-ферма насекомых для еды

**Изоляция и безопасность:**
- Герметичный изолятор
- Подземная церковь
- Проход в секретные тоннели под городом

### 8.2 Специальные секретные комнаты (по катастрофам)

**За день до ядерной войны:**
- Картотека секретных военных архивных документов
- Тюрьма
- Зал совещаний с картой подземных тоннелей

**Разрушение Луны:**
- Обсерватория с телескопом
- Склад противорадиационной брони
- Карта зон повышенного риска
- Лаборатория анализа обломков

**Солнечный супер-шторм:**
- Столярная мастерская
- Склад механических часов
- Ручной генератор энергии
- Комната с костюмами радиационной защиты
- Цистерна с 1000 литров керосина
- Гончарная мастерская

**Загадочные миражи:**
- Архив зарисованных миражей
- Комната с покрытием из зеркал (отталкивает "шрамы")
- Дневник пропавших
- Коллекция артефактов из миражей

**Великий нефтяной кризис:**
- Склад аварийных генераторов
- Карта альтернативных источников энергии
- Мастерская по переоборудованию техники
- Био-генератор с многоярусной фермой
- Геотермальная электростанция

**Колодец в преисподнюю:**
- Акустическая лаборатория
- Сейсмический датчик
- Клетка с существом из скважины
- Лифт, ведущий под землю, но куда?

**Нулевая полярность:**
- Подземная обсерватория
- Лаборатория по изучению ядра
- Склад радиационных костюмов
- Карта магнитных аномалий

### 8.3 Рекомендации по использованию

- **Стандартные комнаты** подходят для любой игры и добавляют разнообразие
- **Специальные комнаты** усиливают атмосферу конкретной катастрофы
- Ведущий может комбинировать комнаты или создавать собственные варианты
- Рекомендуется 1-3 секретные комнаты за игру в зависимости от её продолжительности
- Секретная комната должна открываться на 2-3 раунде для максимального эффекта

*Все описания катастроф и комнат являются художественным вымыслом. Любые совпадения с реальностью случайны.* 